<ChiliPairsGame>:
    orientation: 'vertical'
    chiligrid: _chiligrid
    padding: 5
    canvas.before:
        Rectangle:
            pos: self.pos
            size: self.size
            source: "img/ui/bground.png"

    BoxLayout:
        orientation: 'horizontal'
        size_hint: 1, 0.1
        spacing: 10
        Label:
            font_size: 18
            # font_name: 'fonts/Elegantwriter.ttf'
            text: 'Now learning: ' + str(root.set_loaded)

        Label:
            font_size: 18
            text: 'Time: ' + root.elapsed_time_str

    BoxLayout:
        orientation: 'horizontal'
        size_hint: 1, 0.9
        spacing: 10

        ChiliGrid:
            id: _chiligrid
            chiligame: root

        BoxLayout
            orientation: 'vertical'
            size_hint: 0.15, 1
            spacing: 30

            HelpButton:
                text: ' Show \n Cards (' + str(root.showcards_helper.remaining) + ')'
                font_name: 'fonts/Tequilla_sunrise.ttf'
                font_size: 14
                on_press: root.use_help('show')

            HelpButton:
                font_size: 14
                font_name: 'fonts/Tequilla_sunrise.ttf'
                text: ' Guess \n Object (' + str(root.guessobj_helper.remaining) + ')'
                on_press: root.use_help('guess')

            PauseButton:
                color: 112/255.,128/255.,144/255., 0.9
                on_press: 
                    self.color = 187/255., 1, 23/255., 1
                    root.pause_game()

                on_touch_up:
                    self.color = 112/255.,128/255.,144/255., 0.9

    Label:
        size_hint: 1, 0.05
        color: 1, 0, 0, 0.7
        markup: True
        font_size: 14
        text: '[i]'+root.alert_msg+'[/i]'

<ChiliGrid>:
    spacing: 10
    size_hint: 0.9, 1 
    gridsize: 4, 6

<ChiliCard>:
    orientation: 'vertical'
    size: 100, 100
    back_widget: _back.__self__
    padding: 2
    canvas:
        Color:
            rgba: self.bgcolor
        Rectangle:
            size: self.size
            pos: self.pos

    Button:
        id: _back
        pos: root.pos
        size: root.size
        on_press: root.flip()

        canvas:
            
            Color:
                rgba: root.back_color
            Rectangle:
                pos: self.pos
                size: self.size
            Rectangle:
                pos: self.pos
                size: self.size
                source: root.back_img


<ChiliMenu@BoxLayout>:
    size: root.size
    pos: root.pos
    orientation: "vertical"
    set_options: _set_options
    chiligame: None
    continue_btn: _continue_btn
    restart_btn: _restart_btn

    Accordion:
        orientation: "vertical"
        AccordionItem:
            title: "New Game"
            collapse: True
            BoxLayout:
                id: _set_options
                chiligame: root.chiligame
                orientation: "vertical"
        AccordionItem:
            title: "Settings"
            title_template: "AccordionItemTitle"
    Button:
        id: _continue_btn
        text: "Continue"
        disabled: True
        size_hint: 1, 0.1
        on_press: root.chiligame.pause_game()

    Button:
        id: _restart_btn
        text: "Restart"
        disabled: True
        size_hint: 1, 0.1
        on_press: root.chiligame.restart_game()

<SetButton@Button>:
    background_color: 0, 1, 0, 1
    set_id: -1
    on_press: 
        self.parent.chiligame.new_game(self.set_id)
        self.parent.chiligame.hide_menu()

<HelpButton@ButtonBehavior+Label>:
    size_hint: 1, 0.2
    canvas.before:
        Color:
            rgba: 1, 0, 0, 1
        Rectangle:
            pos: self.pos
            size: self.size

<PauseButton@ButtonBehavior+Image>:
    source: "img/ui/pause_btn.png"
    color: 1, 1, 1, 1

[AccordionItemTitle@Button]:
    text: ctx.title
    canvas.before:
        Color:
            rgb: 1, 1, 1
        BorderImage:
            source:
                ctx.item.background_normal \
                if ctx.item.collapse \
                else ctx.item.background_selected
            pos: self.pos
            size: self.size
        PushMatrix
        Translate:
            xy: self.center_x, self.center_y
        Rotate:
            angle: 90 if ctx.item.orientation == 'horizontal' else 0
            axis: 0, 0, 1
        Translate:
            xy: -self.center_x, -self.center_y
    canvas.after:
        PopMatrix
    on_press: print "press"
